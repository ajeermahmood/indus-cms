<div class="main-content">
  <div class="container-fluid">
    <div class="custom-loader" *ngIf="!cropper_ready && imgSelected">
      <mat-spinner [diameter]="50"></mat-spinner>
    </div>
    <div class="card">
      <div class="card-header">Select Image</div>
      <div class="card-body" style="padding: 30px 40px">
        <ul style="padding-left: 20px">
          <li>Browse and select the image you want to crop or resize.</li>
          <li>Drag-and-drop the image file.</li>
          <li>Paste the image from the clipboard (Ctrl-V or âŒ˜V).</li>
        </ul>
        <input
          #input
          class="d-none"
          multiple
          type="file"
          accept="image/*"
          id="file"
          (change)="fileChangeEvent($event)"
        />
        <div class="btn browse-btn" (click)="input.click()">
          <mat-icon>cloud_upload</mat-icon>Browse...
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">Crop Image (optional)</div>
      <div class="card-body" style="padding: 30px 40px">
        <ul style="padding-left: 20px">
          <li *ngIf="!imgSelected">Select Image First.</li>
          <li *ngIf="imgSelected">Crop selected Image.</li>
        </ul>

        <image-cropper
          [imageChangedEvent]="imageChangedEvent"
          [maintainAspectRatio]="maintainAspectRatio"
          [aspectRatio]="aspectRatio"
          [resizeToWidth]="256"
          [cropperMinWidth]="128"
          [onlyScaleDown]="true"
          [roundCropper]="false"
          [canvasRotation]="canvasRotation"
          [transform]="transform"
          [alignImage]="'left'"
          [style.display]="showCropper ? null : 'none'"
          format="png"
          (imageCropped)="imageCropped($event)"
          (imageLoaded)="imageLoaded()"
          (cropperReady)="cropperReady($event)"
          (loadImageFailed)="loadImageFailed()"
          class="mb-4"
          style="max-height: 70rem"
        ></image-cropper>

        <div class="row m-0">
          <div class="col-3">
            <h3 class="crop-settings-title">Aspect Ratio</h3>
            <mat-form-field appearance="outline">
              <mat-label>Aspect Ratio</mat-label>
              <mat-select (selectionChange)="aspectRatioChange($event)">
                <mat-option
                  *ngFor="let asp of aspectRatios"
                  [value]="asp.value"
                >
                  {{ asp.viewValue }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-5">
            <h3 class="crop-settings-title">Rotate or Flip</h3>
            <div class="row m-0 align-items-center">
              <div
                style="margin-top: -13px"
                class="btn crop-sett-btns"
                (click)="rotateLeft()"
                matTooltip="Rotate Left"
                matTooltipClass="tooltip"
                matTooltipPosition="above"
              >
                <mat-icon>rotate_left</mat-icon>
              </div>
              <div
                style="margin-top: -13px"
                class="btn crop-sett-btns"
                (click)="rotateRight()"
                matTooltip="Rotate Right"
                matTooltipClass="tooltip"
                matTooltipPosition="above"
              >
                <mat-icon>rotate_right</mat-icon>
              </div>
              <div
                style="margin-top: -13px"
                class="btn crop-sett-btns"
                (click)="flipHorizontal()"
                matTooltip="Flip Horizontal"
                matTooltipClass="tooltip"
                matTooltipPosition="above"
              >
                <mat-icon>flip</mat-icon>
              </div>
              <div
                style="margin-top: -13px"
                class="btn crop-sett-btns"
                (click)="flipVertical()"
                matTooltip="Flip Vertical"
                matTooltipClass="tooltip"
                matTooltipPosition="above"
              >
                <mat-icon style="transform: rotate(90deg)">flip</mat-icon>
              </div>
              <mat-form-field appearance="outline" style="width: 65px">
                <mat-label>Rotate</mat-label>
                <input
                  matInput
                  [(ngModel)]="rotation"
                  type="number"
                  (click)="updateRotation()"
                />
              </mat-form-field>
            </div>
          </div>
          <div class="col-2">
            <h3 class="crop-settings-title">Zoom</h3>
            <div class="row m-0 align-items-center">
              <div
                style="margin-top: 4px"
                class="btn crop-sett-btns"
                (click)="zoomIn()"
                matTooltip="Zoom In"
                matTooltipClass="tooltip"
                matTooltipPosition="above"
              >
                <mat-icon>zoom_in</mat-icon>
              </div>
              <div
                style="margin-top: 4px"
                class="btn crop-sett-btns"
                (click)="zoomOut()"
                matTooltip="Zoom Out"
                matTooltipClass="tooltip"
                matTooltipPosition="above"
              >
                <mat-icon>zoom_out</mat-icon>
              </div>
            </div>
          </div>
          <div class="col-2">
            <h3 class="crop-settings-title">Reset</h3>
            <div class="row m-0 align-items-center">
              <div
                style="margin-top: 4px"
                class="btn crop-sett-reset-btn"
                (click)="resetImage()"
              >
                <mat-icon>settings_backup_restore</mat-icon>Reset
              </div>
            </div>
          </div>
        </div>

        <!-- <div class="btn browse-btn mt-3"><mat-icon>save</mat-icon>Save</div> -->
      </div>
    </div>
    <div class="card">
      <div class="card-header">Resize Image</div>
      <div class="card-body" style="padding: 30px 40px">
        <div class="row m-0">
          <div class="col-6">
            <h3 class="crop-settings-title">Resize Dimensions</h3>
            <mat-form-field appearance="outline">
              <mat-label>Width</mat-label>
              <input
                matInput
                [(ngModel)]="resize_width"
                type="number"
                (click)="clickResizeDimention('w')"
              />
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Height</mat-label>
              <input
                matInput
                [(ngModel)]="resize_height"
                type="number"
                (click)="clickResizeDimention('h')"
              />
            </mat-form-field>
            <mat-checkbox class="example-margin" [(ngModel)]="lockAspectRatio"
              >Lock aspect ratio</mat-checkbox
            >
          </div>
          <div class="col-6">
            <h3 class="crop-settings-title">Scale Percentage</h3>
            <mat-form-field appearance="outline">
              <mat-label>Scale %</mat-label>
              <input
                matInput
                [(ngModel)]="resize_scale"
                type="number"
                (click)="resizeImage()"
              />
            </mat-form-field>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">Save Image</div>
      <div class="card-body" style="padding: 30px 40px">
        <div class="row m-0">
          <div class="col-6">
            <h3 class="crop-settings-title">Export As</h3>
            <mat-form-field appearance="outline">
              <mat-label>Image Formats</mat-label>
              <mat-select [(ngModel)]="img_format">
                <mat-option *ngFor="let f of imgFormats" [value]="f.value">
                  {{ f.viewValue }}
                </mat-option>
              </mat-select>
            </mat-form-field>
            <h3 class="crop-settings-title">Quality</h3>
            <mat-form-field appearance="outline">
              <mat-label>Quality</mat-label>
              <input matInput [(ngModel)]="img_quality" type="number" />
            </mat-form-field>
          </div>
          <div class="col-6">
            <h3 class="crop-settings-title">File Name</h3>
            <mat-form-field appearance="outline">
              <mat-label>Type file name</mat-label>
              <input matInput [(ngModel)]="img_file_name" type="text" />
            </mat-form-field>
            <h3 class="crop-settings-title">File Size</h3>
            <p style="font-size: 15px; font-weight: 600; color: #13cb13">
              {{ fileSize }}
            </p>
          </div>
        </div>

        <div class="row m-0 justify-content-end">
          <div class="btn browse-btn ml-3" (click)="download()">
            <mat-icon>cloud_download</mat-icon>Download
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
